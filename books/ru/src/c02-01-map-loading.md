# Загрузка карты

В предыдущей главе мы остановились на том, что создали несколько сущностей и протестировали систему отрисовки. Теперь пришло время отрисовать подходящую карту. Для этого мы создадим текстовую конфигурацию карты, которую будем использовать для загрузки.

## Конфигурация карты

Первым делом попробуем загрузить уровень, основанный на 2D-карте, которая выглядит следующим образом:

```
{{#include ../../../code/rust-sokoban-c02-01/src/main.rs:181:189}}

где:
. — пустое место
W — стена (wall)
P — игрок (player)
B — коробка (box)
S — место для коробки (box spot)
N — используется для внешних границ карты (nothing)
```

Напишем для этого следующую строку. Однажды мы будем загружать это из файла, но для простоты пока остановимся на строковой константе в коде.

```rust
{{#include ../../../code/rust-sokoban-c02-01/src/main.rs:179:193}}
```

Ниже — реализация загрузки карты:

```rust
{{#include ../../../code/rust-sokoban-c02-01/src/main.rs:195:234}}
```

Пожалуй, самая интересная концепция Rust — это `match`. Здесь мы используем только базовые функции сопоставления с образцом: мы просто смотрим значение каждого токена из конфигурации карты. Но позже с помощью этого инструмента мы сможем создавать куда более сложные условия или типы образцов.

> ***ЕЩЁ:*** Узнать больше про сопоставление с образцами вы можете [здесь](https://doc.rust-lang.org/book/ch06-02-match.html).

Теперь давайте запустим игру и посмотрим, как выглядит наша карта:

![Screenshot](./images/map.png)

Окончательная версия кода:

```rust
{{#include ../../../code/rust-sokoban-c02-01/src/main.rs}}
```

> ***КОД:*** Увидеть весь код из данной главы можно [здесь](https://github.com/iolivia/rust-sokoban/tree/master/code/rust-sokoban-c02-01).
